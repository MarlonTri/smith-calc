%%% template.tex
%%% This is a template for making up an AMS-LaTeX file
%%% Version of February 12, 2011
%%%---------------------------------------------------------
%%% The following command chooses the default 10 point type.
%%% To choose 12 point, change it to
%%% \documentclass[12pt]{amsart}
\documentclass{amsart}

%%% The following command loads the amsrefs package, which will be
%%% used to create the bibliography:
\usepackage[lite]{amsrefs}

%%% The following command defines the standard names for all of the
%%% special symbols in the AMSfonts package, listed in
%%% http://www.ctan.org/tex-archive/info/symbols/math/symbols.pdf
\usepackage{amssymb}

%%% The following commands allow you to use \Xy-pic to draw
%%% commutative diagrams.  (You can omit the second line if you want
%%% the default style of the nodes to be \textstyle.)
\usepackage[all,cmtip]{xy}
\let\objectstyle=\displaystyle

\usepackage{siunitx}
%%% If you'll be importing any graphics, uncomment the following
%%% line.  (Note: The spelling is correct; the package graphicx.sty is
%%% the updated version of the older graphics.sty.)
% \usepackage{graphicx}



%%% This part of the file (after the \documentclass command,
%%% but before the \begin{document}) is called the ``preamble''.
%%% This is where we put our macro definitions.

%%% Comment out (or delete) any of these that you don't want to use.
\newcommand{\tensor}{\otimes}
\newcommand{\homotopic}{\simeq}
\newcommand{\homeq}{\cong}
\newcommand{\iso}{\approx}

\DeclareMathOperator{\ho}{Ho}
\DeclareMathOperator*{\colim}{colim}

\newcommand{\R}{\mathbb{R}}
\newcommand{\RE}{{49081}}
\newcommand{\ME}{{665829}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}

\newcommand{\M}{\mathcal{M}}
\newcommand{\W}{\mathcal{W}}

\newcommand{\itilde}{\tilde{\imath}}
\newcommand{\jtilde}{\tilde{\jmath}}
\newcommand{\ihat}{\hat{\imath}}
\newcommand{\jhat}{\hat{\jmath}}

\usepackage{mathtools}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}


%%%-------------------------------------------------------------------
%%%-------------------------------------------------------------------
%%% The Theorem environments:
%%%
%%%
%%% The following commands set it up so that:
%%% 
%%% All Theorems, Corollaries, Lemmas, Propositions, Definitions,
%%% Remarks, Examples, Notations, and Terminologies  will be numbered
%%% in a single sequence, and the numbering will be within each
%%% section.  Displayed equations will be numbered in the same
%%% sequence. 
%%% 
%%% 
%%% Theorems, Propositions, Lemmas, and Corollaries will have the most
%%% formal typesetting.
%%% 
%%% Definitions will have the next level of formality.
%%% 
%%% Remarks, Examples, Notations, and Terminologies will be the least
%%% formal.
%%% 
%%% Theorem:
%%% \begin{thm}
%%% 
%%% \end{thm}
%%% 
%%% Corollary:
%%% \begin{cor}
%%% 
%%% \end{cor}
%%% 
%%% Lemma:
%%% \begin{lem}
%%% 
%%% \end{lem}
%%% 
%%% Proposition:
%%% \begin{prop}
%%% 
%%% \end{prop}
%%% 
%%% Definition:
%%% \begin{defn}
%%% 
%%% \end{defn}
%%% 
%%% Remark:
%%% \begin{rem}
%%% 
%%% \end{rem}
%%% 
%%% Example:
%%% \begin{ex}
%%% 
%%% \end{ex}
%%% 
%%% Notation:
%%% \begin{notation}
%%% 
%%% \end{notation}
%%% 
%%% Terminology:
%%% \begin{terminology}
%%% 
%%% \end{terminology}
%%% 
%%%       Theorem environments

% The following causes equations to be numbered within sections
\numberwithin{equation}{section}

% We'll use the equation counter for all our theorem environments, so
% that everything will be numbered in the same sequence.

%       Theorem environments

\theoremstyle{plain} %% This is the default, anyway
\newtheorem{thm}[equation]{Theorem}
\newtheorem{cor}[equation]{Corollary}
\newtheorem{lem}[equation]{Lemma}
\newtheorem{prop}[equation]{Proposition}


\theoremstyle{definition}
\newtheorem{defn}[equation]{Definition}
\newtheorem{fact}{Fact}


\theoremstyle{remark}
\newtheorem{rem}[equation]{Remark}
\newtheorem{ex}[equation]{Example}
\newtheorem{notation}[equation]{Notation}
\newtheorem{terminology}[equation]{Terminology}


%%%-------------------------------------------------------------------
%%%-------------------------------------------------------------------
%%%-------------------------------------------------------------------
%%%-------------------------------------------------------------------
%%%-------------------------------------------------------------------
%%%-------------------------------------------------------------------
%%%-------------------------------------------------------------------
\begin{document}

%%% In the title, use a double backslash "\\" to show a linebreak:
%%% Use one of the following two forms:
%%% \title{Text of the title}
%%% or
%%% \title[Short form for the running head]{Text of the title}
\title{Largest Smith Number \\ (PAPER IN PROGRESS)}


%%% If there are multiple authors, they're described one at a time:
%%% First author: \author{} \address{} \curraddr{} \email{} \thanks{}
%%% Second author: \author{} \address{} \curraddr{} \email{} \thanks{}
%%% Third author: \author{} \address{} \curraddr{} \email{} \thanks{}
\author{Marlon Trifunovic}

%%% In the address, show linebreaks with double backslashes:
\address{}

%%% Current address is optional.
% \curraddr{}

%%% Email address is optional.
% \email{}


%%% If there's a second author:
% \author{}
% \address{}
% \curraddr{}
% \email{}


%%% To have the current date inserted, use \date{\today}:
\date{\today}

%%% To include an abstract, uncomment the following two lines and type
%%% the abstract in between them:
 \begin{abstract}
We find large Smith numbers by explicitly calculating digit sums through several methods relying on computer programs. This paper explicitly constructs a Smith number with \num{1094654215464} digits, exceeding previous record of \num{32066910} digits.
 \end{abstract}


\maketitle

%%% To include a table of contents, uncomment the following line:
 \tableofcontents


%-------------------------------------------------------------------
%-------------------------------------------------------------------
 %Start the body of the paper here!  E.G., maybe use:
 \section{Introduction}

A Smith number is defined by A. Wilanksy as ``a composite number the sum of whose digits is the sum of all digits of all its prime factors''\cite{Wilansky1982}.



 \section{Notation and Basic Facts}
The following notation and basic facts are taken from Patrick Costello \cite{Costello2002}. For any positive integer $n$, let $S(n)$ denote the sum of the digits of $n$. For any positive integer $n$, let $S_p(n)$ denote the sum of digits of the prime factorization of $n$. For example, $S(12) = 1 + 2 = 3$ and $S_p(12) = S_p(2\cdot 2 \cdot 3) = 2 + 2 + 3 = 7$.


 \section{An update on Costello 2002}
 Patrick Costello was able to construct a $32,066,910$ digit Smith number by using the known prime repunit $R_{1031}$ and Chris Caldwell's large palindromic prime $M = 10^{28572} + 8 \cdot 10^{14286} + 1$. I will briefly go through the similar steps as Costello with more recently verified primes to construct a new largest Smith number.

 Firstly, two facts are necessary

\begin{fact}[{Lewis \cite{Lewis1994}}]
If you multiply $9R_n$ by any natural number less than $9R_n$, then the digit sum is $9n$, i.e.,
$S(M \cdot 9R_n) = 9M = S(9R_n)$  when $M < 9R_n$.
\end{fact}

\begin{fact}[{Wayland, Oltikar \cite{OltikarWayland1983}}]
If $S(u) > S_p(u)$ and $S(u) = S_p(u) \pmod{7}$, then $10^k \cdot u$ is a Smith number, where $k =\frac{S(u)-S_p(u)}{7}$.
\end{fact}

Chris Caldwell's list of large proven primes\cite{Caldwell3} lists the prime $M=  3 \cdot 10^{665829} + 1$. It additionally lists the large prime repunit $R_\RE$ discovered and proven by Paul Underwood\cite{CaldwellR}. Notice that $M$ is not palindromic and requires different method for bounding coefficients than Costello's 2002 paper.


 For a power $t$, the term $M^t$ can be represented as a sum of coefficients multiplied by powers of $10^\ME$.
$$M^t = \sum_{k = 0}^t c_k  10^{\ME k}, \quad c_{t,k} = \binom{t}{k} 3^k $$
When $t$ is fixed, I will drop the $t$ for ease of notation: $c_{k} = c_{t,k}$.
\begin{thm} Fix $t> 0$ and let $k(t) =  \ceil{\frac{3t-1}{4}}$, then $ c_{k} \leq c_{k(t)}$ for $0 \leq k \leq t$.
\end{thm}
\begin{proof}
Define the ratio of coefficients $b_k = \frac{c_{k+1}}{c_k}$, then 
\begin{align*}
b_k &=  \frac{c_{k+1}}{c_k}\\
&= \frac{ \binom{t}{k+1} 3^{k+1}}{ \binom{t}{k} 3^k}\\
&=  \frac{3  \frac{1}{(k+1)! (t - (k+1))!}}{\frac{1}{k! (t - k)!}}\\
b_k &= \frac{ 3(t-k)}{k + 1}
\end{align*}
Notice that the $b_k$ ratios are decreasing with $b_{t-1} < 1 < b_0$. Then $k(t) = \ceil{\frac{3t-1}{4}}$ is the minimal integer so that $b_{k(t)} \leq  1$. Since these $b_k$ are ratios of $c_k$, $c_{k(t)}$ is the largest coefficient. 
\end{proof}
\begin{thm} Fix $t \leq 81525$ and suppose $N = 9 R_{49081} M^t$, then for all $0 \leq k \leq t$,  $c_{t,k} < 9R_{\RE}$ and $9 R_{\RE} c_{t,k} < 10^\ME$.
\end{thm}
\begin{proof}
Fix $t,k$ as in the theorem, then by Theorem 3.1,
\begin{align*}
c_{t,k} & \leq c_{t,k(t)} \\
&= \binom{t}{k(t)} 3^{k(t)}
\end{align*}
Define that last line as $f(t)$, which is an increasing function. By explicit calculation,$$f(t) \leq f(81525) < 9R_\RE < f(81526) $$
Since $(9R_{\RE})^2 < 10^\ME$, then  $9 R_{\RE} c_{t,k} < 10^\ME$ as well.

\end{proof}

Now suppose $N = 9 R_{49081} M^t$ for a power $t\leq 81525$. We know each coeffient $c_k < 9R_{\RE}$ and $9 R_{\RE} c_k < 10^\ME$. The latter constraint means the digit sum of $N$ is the sum of the digit sums of $9 R_{49081} c_k$. The first constraint allows us to apply fact 1 to prove the digit sum of $ 9 R_{49081} c_k$ is $9 \cdot 49081$. Since $k$ varies from $0 \leq k \leq t$, then
$$S(N) = (t+1) \cdot 9 \cdot 49081$$
The prime factorization of $N$ is simply $3\cdot 3 \cdot R_\RE \cdot M^t$. Keeping in mind $S(M) = 4$, then
$$S_p(N) = 3 + 3 + \RE + 4t$$
Note that $S(N) > S_p(N)$ and 
\begin{align*}
S(N) - S_p(N) &= (t+1) \cdot 9 \cdot \RE - (3 + 3 + \RE + 4t) \\
&= 441725 t + 392642 \\
&= 4t +5 \pmod{7}\\
&= 4(t +3) \pmod{7}
\end{align*}
Fix $t=81519$, then $t \equiv 4 \pmod{7}$ and $t \leq 81525$. By above, $S(N) - S_p(N) \equiv 0 \pmod{7}$. Calculate $k$
$$k = \frac{ S(N) - S_p(N)}{7} = \frac{441725 t + 392642}{7} = 5144196131$$
then Fact 2 to proves $10^k N$ is a Smith number. The explicit description for this Smith number is
\begin{align*}
10^k N &= (3\cdot 10^\ME + 1)^t \cdot 9R_\RE \cdot 10^k \\
&=  (3\cdot 10^\ME + 1)^{81519} \cdot (10 ^{49081} -1 ) \cdot 10^{ 5144196131}
\end{align*}
This Smith number has \num{59421998358} digits.
%\begin{align*}
%\log_{10} 10^k N &= 5144196131 +\log_{10} 9 R_\RE M^t \\ 
% &= 5144196131 +\log_{10} 9 R_\RE  + t \log_{10} M \\ 
% &= 5144196131 +  49080.99999999999  + t \cdot 665829.4771212545 \\ 
%&= 59421998357.44755
%\end{align*} 
\\ 
 \section{Best by adding coefficients}
The previous section relied on {\bf Fact 1} to greatly simplify calculation of the coefficient digit sums. This caused the coefficient $t=81519$ to be limited by the size of a provably-prime repunit $R_\RE$. With modern processors, it is possible to explicitly calculate each coefficient and the resulting digit sum, allowing us to discard the $R_\RE$ from the product and achieve far larger $t$ powers. 

For selecting a power $t$ of $M^t$ while planning to explicitly calculate each $S(c_{t,k})$, we only need to worry about two constraints. Firstly, it is necessary that $S(M^t) = S_p(M^t) \pmod{7}$ to apply {\bf Fact 2}. Secondly, $t$ will need to be small enough that each coefficient $c_{t,k} < 10^\ME$ so that the coefficients can be separated in the digit representation. By Theorem 3.1, it's sufficient to show that only $c_{t,k(t)} < 10^\ME$.

After a somewhat quick search for a bound on the second constraint, I found that fixing $t_0 = 1105923$ yields
\begin{align*}
c_{t_0,k(t_0)} &=          8.5967... \cdot 10 ^{665828}  < 10^{665829}
\end{align*}
This is maximal as 
\begin{align*}
10^{665829} < c_{t_0+1,k(t_0 + 1)}  =    3.4387... \cdot 10 ^{665829}
\end{align*}

As long as $t \leq t_0$, then the second constraint is satisfied. Since we are not relying on ${\bf Fact 1}$, the digit sum of $M^t$ is much less predictable. Therefor, finding a $t \leq t_0$ so that $S(M^t) = S_p(M^t) \pmod{7}$ simply involves checking $t_0, t_0 -1 , t_0 -2,...$ until one of these values happen to satisfy the congruence.

By a lucky $\frac{1}{7}$ chance, it turns out $S(M^{t_0}) =  S_p(M^{t_0}) \pmod{7}$. This took 4-ish hours to calculate using all cores on an AMD Ryzen 7 5800X 8-Core Processor.
\begin{align*}
S(M^{t_0})&=  2508098743612       \\
S_p(M^{t_0}) &= (3+ 1) \cdot  1105923 =  4423692   \\
S(M^{t_0}) -  S_p(M^{t_0}) &= 2508094319920
\end{align*}

Let $k = \frac{S(M^{t_0}) -  S_p(M^{t_0}) }{7} = 358299188560$, then finally let $N = M^{t_0} 10^k$. $N$ is a Smith number with explicit form
$$N = (3\cdot 10^\ME + 1)^{1105923} \cdot 10^{358299188560}$$
This Smith number has $\num{1094654215464}$ digits.
\,\\ \section{Implementation \& Afterword}
% \label{sec:intro}

% For a numbered display, use
 %\begin{equation}
  % \label{something}
   %The display goes here
% \end{equation}
% and you can refer to it as% \eqref{something}.

 %For an unnumbered display, use
 %\begin{equation*}
 
 %\end{equation*}

 %To import a graphics file, you must have said
 %\usepackage{graphicx}
% in the preamble (i.e., before the \begin{document}).
% Putting it into a figure environment enables it to float to the
% next page if there isn't enough room for it on the current page.
% The \label command must come after the \caption command.
 %\begin{figure}[h]%
   %\includegraphics{filename}
 %  \caption{Some caption}
  % \label{somelabel}
% \end{figure}















%%% -------------------------------------------------------------------
%%% -------------------------------------------------------------------
%%% This is where we create the bibliography.

\,\\
\begin{bibdiv}
  \begin{biblist}

%%% The format of bibliography items is as in the following examples:
%%% 
%%% \bib{yellowmonster}{book}{
%%%   author={Bousfield, A.K.},
%%%   author={Kan, D.M.},
%%%   title={Homotopy Limits, Completions and Localizations},
%%%   date={1972},
%%%   series={Lecture Notes in Mathematics},
%%%   volume={304},
%%%   publisher={Springer-Verlag},
%%%   address={Berlin-New York}
%%% }

%%% \bib{HA}{book}{
%%%   author={Quillen, Daniel G.},
%%%   title={Homotopical Algebra},
%%%   series={Lecture Notes in Mathematics},
%%%   volume={43},
%%%   publisher={Springer-Verlag},
%%%   address={Berlin-New York},
%%%   date={1967}
%%% }

\bib{Witno2010}{article}{
author = {Amin Witno},
title = {Another Simple Construction of Smith Numbers},
volume = {22},
journal = {Missouri Journal of Mathematical Sciences},
number = {2},
publisher = {University of Central Missouri, Department of Mathematics and Computer Science},
pages = {97 -- 101},
year = {2010},
doi = {10.35834/mjms/1312233139},
URL = {https://doi.org/10.35834/mjms/1312233139}
}
 
\bib{Costello2015}{article}{
author = {Patrick Costello},
title = {{Smith Numbers From Primes with Small Digits}},
volume = {27},
journal = {Missouri Journal of Mathematical Sciences},
number = {1},
publisher = {University of Central Missouri, Department of Mathematics and Computer Science},
pages = {10 -- 15},
keywords = {primes with small digits, Smith numbers},
year = {2015},
doi = {10.35834/mjms/1449161363},
URL = {https://doi.org/10.35834/mjms/1449161363}
}
\bib{Costello2002}{article}{
author = {Costello, Patrick},
year = {2002},
month = {08},
pages = {},
title = {A new largest Smith number},
volume = {40},
journal = {The Fibonacci Quarterly}
}

\bib{Lewis1994}{thesis}{
  title={Smith numbers: an infinite subset of N},
  author={Lewis, Kathy Sharon},
  year={1994},
  school={Eastern Kentucky University}
}

\bib{Wilansky1982}{article}{
author = {A. Wilansky},
title = {Smith Numbers},
journal = {The Two-Year College Mathematics Journal},
volume = {13},
number = {1},
pages = {21-21},
year  = {1982},
publisher = {Taylor & Francis},
doi = {10.1080/00494925.1982.11972573},
%URL = {   https://www.tandfonline.com/doi/abs/10.1080/00494925.1982.11972573 },
%eprint = {   https://www.tandfonline.com/doi/pdf/10.1080/00494925.1982.11972573 }
}

\bib{OltikarWayland1983}{article}{
author = {Sham Oltikar and Keith Wayland},
title = {Construction of Smith Numbers},
journal = {Mathematics Magazine},
volume = {56},
number = {1},
pages = {36-37},
year  = {1983},
publisher = {Taylor & Francis},
doi = {10.1080/0025570X.1983.11977013},
%URL = {   https://doi.org/10.1080/0025570X.1983.11977013 },
%eprint = {  https://doi.org/10.1080/0025570X.1983.11977013 }
}


\bib{Caldwell3}{webpage}{
 title={PrimePage Primes: 3 · 10\^{}665829 + 1},
  url={https://primes.utm.edu/primes/page.php?id=109247},
  %howpublished = "\url{http://aiweb.techfak.uni-bielefeld.de/content/bworld-robot-control-software/}",
  journal={PrimePage Primes},
 author={Caldwell, Chris K},
 year={2012} 
}
\bib{CaldwellR}{webpage}{
 title={PrimePage Primes: R(49081)},
  url={https://primes.utm.edu/primes/page.php?id=133761},
  %howpublished = "\url{http://aiweb.techfak.uni-bielefeld.de/content/bworld-robot-control-software/}",
  journal={PrimePage Primes},
 author={Chris\,K\,Caldwell and Paul Underwood},
 year={2021} 
}




  \end{biblist}
\end{bibdiv}

\end{document}